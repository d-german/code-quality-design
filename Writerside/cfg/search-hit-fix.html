<!-- cfg/search-hit-fix.html -->
<script>
    (function () {
        const bad = /\s*:\s*undefined\s*$/;          // text to remove

        /** remove ": undefined" from one title element */
        function clean(el) {
            if (!el || !el.textContent) return;
            if (bad.test(el.textContent))
                el.textContent = el.textContent.replace(bad, '');
        }

        /** run once, then watch for new hits */
        function init() {
            // 1 clean any titles already in the list
            document.querySelectorAll('.quick-search__title').forEach(clean);

            // 2 keep cleaning as new results arrive
            const obs = new MutationObserver(ms =>
                ms.forEach(m =>
                    m.addedNodes.forEach(n =>
                        n.querySelectorAll?.('.quick-search__title').forEach(clean)
                    )
                )
            );
            obs.observe(document.body, {childList: true, subtree: true});
        }

        // run when DOM is ready
        if (document.readyState === 'loading')
            document.addEventListener('DOMContentLoaded', init);
        else
            init();
    })();
</script>
